{{template "_header.html" .}}
{{template "_sidebar.html" .}}

<div id="content-wrapper" class="d-flex flex-column">
    <div id="content">
        {{template "_topbar.html" .}}
        <div class="container-fluid">

            <h1 class="h3 mb-4 text-gray-800" id="page-title">
                <i class="fas fa-plus-circle mr-2 text-gray-400"></i>Buat Template Baru
            </h1>

            <form id="template-form">
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">
                            <i class="fas fa-info-circle mr-2"></i>Informasi Dasar Template
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Nama Barang (Tipe)</label>
                                    <input type="text" class="form-control auto-uppercase" id="nama_barang" placeholder="Contoh: KTP atau PASPOR" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Nomor Urut</label>
                                    <input type="number" class="form-control" id="urutan" value="10" required>
                                    <small class="text-muted">Urutan tampilan di dropdown.</small>
                                </div>
                            </div>
                            <div class="col-md-2 d-flex align-items-center">
                                <div class="custom-control custom-switch mt-3">
                                    <input type="checkbox" class="custom-control-input" id="is_active" checked>
                                    <label class="custom-control-label" for="is_active">Aktif</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card shadow mb-4">
                    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                        <h6 class="m-0 font-weight-bold text-primary">
                            <i class="fas fa-layer-group mr-2"></i>Konfigurasi Fields (Formulir Dinamis)
                        </h6>
                        <button type="button" class="btn btn-info btn-sm shadow-sm" id="add-field-btn">
                            <i class="fas fa-plus mr-1"></i> Tambah Field Baru
                        </button>
                    </div>
                    <div class="card-body">
                        <p class="small text-muted mb-3"><i class="fas fa-arrows-alt mr-1"></i> Tarik dan lepas (drag and drop) pada judul field untuk mengubah urutan.</p>
                        
                        <div id="fields-container">
                            <div class="text-center py-5 text-gray-500" id="empty-fields-msg">
                                <i class="fas fa-layer-group fa-3x mb-3"></i>
                                <p>Belum ada field konfigurasi.<br>Klik "Tambah Field Baru" untuk mulai.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-end mb-4">
                    <a href="/templates" class="btn btn-secondary mr-2 shadow-sm"><i class="fas fa-times mr-2"></i> Batal</a>
                    <button type="submit" class="btn btn-primary shadow-sm" id="submit-btn"><i class="fas fa-save mr-2"></i> Simpan Template</button>
                </div>
            </form>

        </div>
    </div>
    {{template "_footer.html" .}}
</div>

<template id="field-item-template">
    <div class="card mb-3 field-item border-left-info sortable-item">
        <div class="card-body p-3">
            <div class="d-flex justify-content-between align-items-center mb-2 header-drag-handle" style="cursor: grab; background: #f8f9fc; padding: 5px 10px; border-radius: 5px;">
                <h6 class="font-weight-bold text-info field-title mb-0">
                    <i class="fas fa-grip-lines mr-2 text-gray-400"></i> <span class="title-text">Field Baru</span>
                </h6>
                <button type="button" class="btn btn-danger btn-sm remove-field-btn"><i class="fas fa-trash"></i></button>
            </div>
            <div class="form-row">
                <div class="col-md-4 form-group">
                    <label class="small">Label Form</label>
                    <input type="text" class="form-control form-control-sm field-label" data-key="label" placeholder="Contoh: NIK" required>
                </div>
                <div class="col-md-4 form-group">
                    <label class="small">Tipe Field</label>
                    <select class="form-control form-control-sm field-type" data-key="type">
                        <option value="text">Teks (Input)</option>
                        <option value="number">Angka (Input)</option>
                        <option value="textarea">Area Teks Panjang</option>
                        <option value="date">Tanggal</option>
                        <option value="select">Pilihan (Dropdown)</option>
                    </select>
                </div>
                <div class="col-md-4 form-group">
                    <label class="small">Data Label (Label di Deskripsi)</label>
                    <input type="text" class="form-control form-control-sm field-data-label" data-key="data_label" placeholder="Contoh: No. KTP" required>
                </div>
            </div>
            <div class="form-row">
                <div class="col-md-4 form-group">
                    <label class="small">Placeholder</label>
                    <input type="text" class="form-control form-control-sm field-placeholder" data-key="placeholder" placeholder="Hint di dalam input">
                </div>
                <div class="col-md-8 form-group">
                    <label class="small">Opsi Validasi</label>
                    <div class="d-flex align-items-center flex-wrap">
                        <div class="custom-control custom-checkbox mr-3 mb-2">
                            <input type="checkbox" class="custom-control-input field-required" data-key="required_length" id="req_NEWID">
                            <label class="custom-control-label" for="req_NEWID">Wajib</label>
                        </div>
                        </div>
                </div>
            </div>
        </div>
    </div>
</template>

{{template "_scripts.html" .}}
<script src="/static/vendor/sortable/Sortable.min.js"></script> 
{{template "_itemTemplateFormScript.html" .}}