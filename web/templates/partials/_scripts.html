</div>
</div>
</div>
<a class="scroll-to-top rounded" href="#page-top"><i class="fas fa-angle-up"></i></a>

<style>
    .modal-changelog-header { background: #4e73df; color: white; border-bottom: none; }
    .modal-changelog-header .close { color: white; opacity: 0.8; }
    .modal-changelog-header .close:hover { opacity: 1; }
    .changelog-paper {
        font-family: 'Nunito', sans-serif; font-size: 0.95rem; line-height: 1.7;
        color: #2d3748; background-color: #ffffff; border: 1px solid #e3e6f0;
        border-radius: 0.5rem; padding: 1.5rem; box-shadow: inset 0 2px 4px 0 rgba(0,0,0,0.06);
        white-space: pre-wrap; word-wrap: break-word; max-height: 60vh; overflow-y: auto;
    }
    .version-badge { background-color: rgba(255, 255, 255, 0.2); padding: 0.2rem 0.6rem; border-radius: 0.25rem; font-size: 0.85rem; margin-left: 10px; }
</style>

<div class="modal fade" id="changelogModal" tabindex="-1" role="dialog" aria-labelledby="changelogModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header modal-changelog-header">
                <h5 class="modal-title font-weight-bold" id="changelogModalLabel">
                    <i class="fas fa-rocket mr-2"></i> Catatan Rilis <span class="version-badge">v{{.AppVersion}}</span>
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body bg-light">
                <p class="text-muted small mb-3 ml-1">Daftar perubahan dan perbaikan pada versi ini:</p>
                <div class="changelog-paper">{{ .AppChangelog }}</div>
            </div>
            <div class="modal-footer bg-light border-top-0">
                <button type="button" id="btn-check-update-modal" class="btn btn-outline-primary btn-sm"><i class="fas fa-sync-alt mr-1"></i> Cek Update</button>
                <button type="button" class="btn btn-primary btn-sm shadow-sm" data-dismiss="modal"><i class="fas fa-check mr-1"></i> Tutup</button>
            </div>
        </div>
    </div>
</div>

<script src="/static/vendor/jquery/jquery.min.js"></script>
<script src="/static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/static/vendor/jquery-easing/jquery.easing.min.js"></script>
<script src="/static/js/sb-admin-2.min.js"></script>
<script src="/static/vendor/chart.js/Chart.min.js"></script>
<script src="/static/vendor/datatables/jquery.dataTables.min.js"></script>
<script src="/static/vendor/datatables/dataTables.bootstrap4.min.js"></script>
<script src="/static/vendor/sweetalert2/sweetalert2.all.min.js"></script>
<script src="/static/vendor/datepicker/js/bootstrap-datepicker.min.js"></script>
<script src="/static/vendor/datepicker/locales/bootstrap-datepicker.id.min.js"></script>

<script>
$(document).ready(function() {
    // 1. Global Logout Handler
    $('#logout-btn').on('click', function(e) {
        e.preventDefault();
        $.ajax({
            url: '/api/logout', type: 'POST',
            success: function() { window.location.href = '/login'; },
            error: function() { Swal.fire('Error', 'Gagal logout.', 'error'); }
        });
    });

    // 2. GLOBAL PASSWORD PEEK HANDLER (FIX BUG 5)
    // Script ini akan jalan di SEMUA halaman yang punya class .password-peek
    $('body').on('click', '.password-peek', function() {
        // Cari input sibling dalam parent yang sama (password-wrapper)
        let $input = $(this).siblings('input');
        
        // Toggle Tipe Input
        let type = $input.attr('type') === 'password' ? 'text' : 'password';
        $input.attr('type', type);
        
        // Toggle Icon
        $(this).toggleClass('fa-eye fa-eye-slash');
    });
});
</script>
{{template "_updateScript.html" .}}
</body>
</html>